<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>KU-DETA ã‚·ãƒ•ãƒˆæå‡º</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root{
  --fg:#111827; --muted:#6b7280; --bd:#e5e7eb; --bg:#fafafa; --card:#ffffff;
  --btn:#111827; --ok:#16a34a; --warn:#f59e0b; --lunch:#fff9db; --dinner:#ffe7d6;
}
*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;
     max-width:1100px;margin:24px auto;padding:0 14px;background:var(--bg);color:var(--fg)}
h1{font-size:1.6rem;margin:0 0 .75rem}
.note{color:var(--muted);font-size:.92rem}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
input,select,button,textarea{border:1px solid var(--bd);border-radius:10px;padding:9px 10px;font-size:15px;background:#fff}
button{background:var(--btn);color:#fff;font-weight:700;border:none;cursor:pointer}
button.ghost{background:#fff;color:var(--fg)}
button:hover{opacity:.94}
.card{background:var(--card);border:1px solid var(--bd);border-radius:14px;padding:14px;margin:12px 0}
.grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
.dow{font-weight:700;text-align:center;color:#374151}
.cell{border:1px solid var(--bd);border-radius:10px;min-height:92px;background:#fff;padding:6px;position:relative;cursor:pointer}
.cell.disabled{opacity:.35;pointer-events:none}
.day{position:absolute;top:6px;left:8px;font-weight:700;font-size:.92rem;color:#4b5563}
.mark{position:absolute;bottom:6px;left:6px;right:6px;font-size:.8rem;display:flex;flex-direction:column;gap:3px}
.tag{display:inline-block;border-radius:6px;padding:2px 6px;font-size:.8rem;border:1px solid var(--bd)}
.tag.l{background:var(--lunch)} .tag.d{background:var(--dinner)}
.today{outline:2px solid var(--warn)}
.selected{outline:2px solid var(--btn)}
.pill{background:#f3f4f6;border:1px solid var(--bd);border-radius:999px;padding:6px 10px}
.right{margin-left:auto}
.small{font-size:.88rem}
.msg{margin-top:4px;font-weight:700}
.ok{color:var(--ok)} .err{color:#b91c1c}
ul{padding-left:18px;margin:8px 0}
.box{border:1px dashed var(--bd);border-radius:12px;padding:12px}
.box.l{background:var(--lunch)} .box.d{background:var(--dinner)}
/* 1æ—¥ã”ã¨ã®ç·¨é›†ã‚«ãƒ¼ãƒ‰ */
.daycard{border:1px solid var(--bd);border-radius:12px;padding:12px;background:#fff;margin-top:10px}
.dayhead{display:flex;align-items:center;gap:10px;margin-bottom:8px}
.badge{font-weight:700}
.xbtn{margin-left:auto;background:#fff;border:1px solid var(--bd);color:#111;border-radius:8px;padding:6px 10px}
.seprow{display:grid;grid-template-columns: 140px 1fr 1fr auto;gap:8px;align-items:center}
.seprow .sect{font-weight:700}
.seprow .sect.l{color:#92400e} .seprow .sect.d{color:#7c2d12}
.hl{background:#fef3c7;border:1px solid #fde68a}
.toolbar{display:flex;gap:8px;align-items:center}
.kbd{border:1px solid var(--bd);padding:2px 6px;border-radius:6px;background:#f9fafb}
</style>
</head>
<body>
  <h1>KU-DETA ã‚·ãƒ•ãƒˆæå‡º</h1>

  <!-- åå‰ãƒ­ãƒƒã‚¯ & ãƒ˜ãƒ«ãƒ— -->
  <div class="card">
    <div class="row">
      <strong>ã‚ãªãŸã®åå‰</strong>
      <select id="nameSel" style="min-width:220px"></select>
      <input id="nameNew" placeholder="ï¼ˆæ–°è¦ï¼‰ä¾‹ï¼šä¹…ç´ çœŸå¸Œ" style="min-width:220px">
      <button id="addNameBtn">ï¼‹ ç™»éŒ²</button>
      <button id="lockBtn" class="ghost">âœ”ï¸ ãƒ­ãƒƒã‚¯</button>
      <span id="lockState" class="note"></span>
      <span class="right note small">åŠæœˆã”ã¨ã«æå‡ºã€‚ç· åˆ‡ã¯ <strong>15æ—¥ãƒ»æœˆæœ«</strong>ï¼ˆçŒ¶äºˆ3æ—¥ã¯ç®¡ç†è€…ã®ã¿ç·¨é›†å¯ï¼‰ã€‚æ™‚é–“æŒ‡å®šãªã—ã¯ã€Œâ—¯ã€ã€‚</span>
    </div>
  </div>

  <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒãƒ¼ -->
  <div class="card">
    <div class="row" style="justify-content:space-between;align-items:center">
      <div class="toolbar">
        <button id="prevBtn" class="ghost">Â« å‰æœˆ</button>
        <div class="pill"><span id="ymLabel">YYYYå¹´Mæœˆ</span></div>
        <button id="thisBtn" class="ghost">ä»Šæœˆ</button>
        <button id="nextBtn" class="ghost">æ¬¡æœˆ Â»</button>
        <span class="note small">ã‚¯ãƒªãƒƒã‚¯ã§é¸æŠ / ã‚‚ã†ä¸€åº¦ã§è§£é™¤</span>
      </div>
      <div class="toolbar">
        <span class="pill">é¸æŠä¸­ï¼š<b id="selCount">0</b>æ—¥</span>
        <button id="clearAll" class="ghost">ã™ã¹ã¦è§£é™¤</button>
        <button id="submitAll">ğŸ“¨ ã¾ã¨ã‚ã¦é€ä¿¡</button>
        <button id="toListBtn" class="ghost">æå‡ºä¸€è¦§ã‚’è¦‹ã‚‹</button>
      </div>
    </div>

    <!-- é¸æŠã—ãŸæ—¥ã”ã¨ã®ç·¨é›† -->
    <div id="basket"></div>
    <div id="msg" class="msg"></div>
  </div>

  <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -->
  <div class="card">
    <div class="row small note" style="margin-bottom:8px">
      <span class="pill"> legendï¼š<span class="tag l">ãƒ©ãƒ³ãƒ</span> <span class="tag d">ãƒ‡ã‚£ãƒŠãƒ¼</span> ï¼ ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼é¸æŠæ—¥</span>
    </div>
    <div id="cal" class="grid"></div>
  </div>

  <!-- æœ€æ–°ã®æå‡ºï¼ˆé‡è¤‡åãªã—ã€æ—¥ä»˜ï¼‹åå‰ã®ã¿ï¼‰ -->
  <div class="card">
    <div class="row" style="justify-content:space-between;align-items:center">
      <strong>æœ€æ–°ã®æå‡º</strong>
    </div>
    <ul id="recentList"><li class="note">èª­ã¿è¾¼ã¿ä¸­â€¦</li></ul>
  </div>

<script>
/* ===== Supabase æ¥ç¶š ===== */
const SUPABASE_URL = "https://wnttziqspjkrinymnodz.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndudHR6aXFzcGprcmlueW1ub2R6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNzE0OTMsImV4cCI6MjA3MDc0NzQ5M30.lKbZM4TCtEyhdU9lBnFPMnRWXMpKybqfIWATaD3m0xI";
const supa = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/* ===== è¦ç´  ===== */
const $ = id => document.getElementById(id);
const nameSel=$('nameSel'), nameNew=$('nameNew'), addNameBtn=$('addNameBtn'),
      lockBtn=$('lockBtn'), lockState=$('lockState'),
      msg=$('msg'), basket=$('basket');

/* ===== å†…éƒ¨çŠ¶æ…‹ ===== */
let calYear, calMonth; // 1-based month
// 1æ—¥ã”ã¨ã‚¨ãƒ‡ã‚£ãƒƒãƒˆçŠ¶æ…‹: { 'YYYY-MM-DD': { lunch:{use,free,start,end}, dinner:{...}, note:'' } }
const edits = {};

/* ===== æ™‚åˆ»å€™è£œï¼ˆ30åˆ†åˆ»ã¿ï¼‰ ===== */
const times = {
  lunch: makeTimes(10*60, 16*60),   // 10:00â€“16:00
  dinner: makeTimes(17*60, 24*60),  // 17:00â€“24:00
};
function makeTimes(minStart, minEnd){
  const arr=[];
  for(let m=minStart;m<=minEnd;m+=30){
    const hh=String(Math.floor(m/60)).padStart(2,'0');
    const mm=String(m%60).padStart(2,'0');
    arr.push(`${hh}:${mm}`);
  }
  return arr;
}

/* ===== åå‰ãƒ­ãƒƒã‚¯ ===== */
function loadLock(){
  const nm = localStorage.getItem('shift_name') || '';
  if(nm){
    ensureNameInSelect(nm,true);
    nameSel.value = nm; setLock(true);
  }else setLock(false);
}
function setLock(on){
  nameSel.disabled = on; nameNew.disabled = on; addNameBtn.disabled = on;
  lockBtn.textContent = on ? 'ğŸ”“ å¤‰æ›´' : 'âœ”ï¸ ãƒ­ãƒƒã‚¯';
  lockState.textContent = on ? `ãƒ­ãƒƒã‚¯ä¸­ï¼š${nameSel.value}` : 'æœªãƒ­ãƒƒã‚¯';
}
lockBtn.onclick=()=>{
  const on=nameSel.disabled;
  if(on){ localStorage.removeItem('shift_name'); setLock(false); }
  else{
    const v=(nameSel.value||'').trim();
    if(!v){ alert('åå‰ã‚’é¸ã¶ã‹ç™»éŒ²ã—ã¦ãã ã•ã„'); return; }
    localStorage.setItem('shift_name',v); setLock(true);
  }
};
addNameBtn.onclick=()=>{
  const nm=nameNew.value.trim(); if(!nm){alert('åå‰ã‚’å…¥åŠ›');return;}
  ensureNameInSelect(nm,true); nameSel.value=nm; nameNew.value='';
  localStorage.setItem('shift_name',nm); setLock(true);
};
function ensureNameInSelect(nm, appendOnly=false){
  const ex = Array.from(nameSel.options).some(o=>o.value===nm);
  if(!ex && appendOnly) nameSel.add(new Option(nm,nm));
}
async function bootstrapNames(){
  const { data } = await supa.from('shifts').select('staff_name').limit(1000);
  const set = new Set((data||[]).map(r=>r.staff_name).filter(Boolean));
  nameSel.innerHTML=''; Array.from(set).sort((a,b)=>a.localeCompare(b,'ja')).forEach(n=>nameSel.add(new Option(n,n)));
  loadLock();
}

/* ===== ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ ===== */
function pad2(n){return String(n).padStart(2,'0');}
function setToToday(){
  const t=new Date(); t.setHours(0,0,0,0);
  calYear=t.getFullYear(); calMonth=t.getMonth()+1;
}
$('prevBtn').onclick=()=>{ changeMonth(-1); };
$('nextBtn').onclick=()=>{ changeMonth(1); };
$('thisBtn').onclick=()=>{ setToToday(); renderCalendar(); loadMonthMarkers(); };
function changeMonth(delta){
  calMonth+=delta; if(calMonth===0){calMonth=12;calYear--;} if(calMonth===13){calMonth=1;calYear++;}
  renderCalendar(); loadMonthMarkers();
}

function renderCalendar(markers={}){
  $('ymLabel').textContent = `${calYear}å¹´${calMonth}æœˆ`;
  const cal=$('cal'); cal.innerHTML='';
  // DOW
  ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'].forEach(w=>{ const d=document.createElement('div'); d.textContent=w; d.className='dow'; cal.appendChild(d); });
  const first=new Date(calYear,calMonth-1,1);
  const startDow=first.getDay();
  const daysInMonth=new Date(calYear,calMonth,0).getDate();
  const todayStr=(d=>`${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`)(new Date());
  // blanks
  for(let i=0;i<startDow;i++){ const e=document.createElement('div'); e.className='cell'; e.style.visibility='hidden'; cal.appendChild(e); }
  // days
  for(let d=1; d<=daysInMonth; d++){
    const ds=`${calYear}-${pad2(calMonth)}-${pad2(d)}`;
    const cell=document.createElement('div'); cell.className='cell';
    if(ds===todayStr) cell.classList.add('today');
    if(edits[ds]) cell.classList.add('selected');
    cell.onclick=()=>toggleSelectDate(ds);
    const num=document.createElement('div'); num.className='day'; num.textContent=d; cell.appendChild(num);
    // markers (æ—¢å­˜æå‡º)
    const m=markers[ds]||{}; const box=document.createElement('div'); box.className='mark';
    if(m.l) box.innerHTML += `<span class="tag l">${m.l}</span>`;
    if(m.d) box.innerHTML += `<span class="tag d">${m.d}</span>`;
    cell.appendChild(box);
    cal.appendChild(cell);
  }
}

async function loadMonthMarkers(){
  const start=`${calYear}-${pad2(calMonth)}-01`;
  const end=new Date(start); end.setMonth(end.getMonth()+1);
  const endStr=end.toISOString().slice(0,10);
  const nm=nameSel.value||'';
  const { data } = await supa
    .from('shifts').select('date,start_time,end_time,staff_name')
    .gte('date',start).lt('date',endStr)
    .order('date',{ascending:true});
  // date -> {l:'', d:''} ï¼ˆåŒæ—¥ã«ãƒ©ãƒ³ãƒ/ãƒ‡ã‚£ãƒŠãƒ¼2è¡Œã‚ã£ã¦ã‚‚ä¸Šæ›¸ãOKï¼‰
  const mk={};
  (data||[]).forEach(r=>{
    const v = (!r.start_time || !r.end_time) ? 'â—¯' : `${r.start_time}ã€œ${r.end_time}`;
    const key = (r.start_time && r.start_time < "16:00") ? 'l' : 'd';
    mk[r.date] ||= {};
    mk[r.date][key] = v;
  });
  renderCalendar(mk);
}

/* ===== é¸æŠ/è§£é™¤ & æ—¥ã”ã¨ã‚¨ãƒ‡ã‚£ã‚¿ ===== */
function toggleSelectDate(ds){
  if(edits[ds]){ delete edits[ds]; }
  else{
    edits[ds] = {
      lunch:  {use:false, free:false, start:"10:00", end:"16:00"},
      dinner: {use:false, free:false, start:"17:00", end:"24:00"},
      note: ""
    };
  }
  renderCalendar(); renderBasket();
}
$('clearAll').onclick=()=>{ Object.keys(edits).forEach(k=>delete edits[k]); renderCalendar(); renderBasket(); };

function renderBasket(){
  $('selCount').textContent = Object.keys(edits).length;
  basket.innerHTML = '';
  const days = Object.keys(edits).sort();
  if(days.length===0){
    basket.innerHTML = `<div class="note">æ—¥ä»˜ã‚’é¸ã¶ã¨ã€ã“ã“ã«1æ—¥ã”ã¨ã®ç·¨é›†æ¬„ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>`;
    return;
  }
  days.forEach(ds=>{
    const st = edits[ds];
    const card=document.createElement('div'); card.className='daycard';
    // header
    const hd=document.createElement('div'); hd.className='dayhead';
    const w = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'][new Date(ds).getDay()];
    hd.innerHTML = `<span class="badge pill">${ds}ï¼ˆ${w}ï¼‰</span>`;
    const del=document.createElement('button'); del.className='xbtn'; del.textContent='âœ• ã“ã®æ—¥ã‚’å¤–ã™';
    del.onclick=()=>{ delete edits[ds]; renderCalendar(); renderBasket(); };
    hd.appendChild(del);
    card.appendChild(hd);

    // ãƒ©ã‚¤ãƒ³ï¼ˆãƒ©ãƒ³ãƒï¼‰
    card.appendChild(makeSectionRow(ds,'lunch','ãƒ©ãƒ³ãƒï¼ˆ10:00â€“16:00ï¼‰',st.lunch,times.lunch));
    // ãƒ©ã‚¤ãƒ³ï¼ˆãƒ‡ã‚£ãƒŠãƒ¼ï¼‰
    card.appendChild(makeSectionRow(ds,'dinner','ãƒ‡ã‚£ãƒŠãƒ¼ï¼ˆ17:00â€“24:00ï¼‰',st.dinner,times.dinner));

    // å‚™è€ƒ
    const memoRow=document.createElement('div'); memoRow.style.marginTop='8px';
    const ta=document.createElement('textarea'); ta.rows=2; ta.style.width='100%'; ta.placeholder='å‚™è€ƒï¼ˆä»»æ„ï¼‰';
    ta.value = st.note || '';
    ta.oninput=()=>{ st.note = ta.value; };
    memoRow.appendChild(ta);
    card.appendChild(memoRow);

    basket.appendChild(card);
  });
}

function makeSectionRow(ds, key, label, state, options){
  const row=document.createElement('div'); row.className='seprow';
  const sect=document.createElement('div'); sect.className='sect '+(key==='lunch'?'l':'d'); sect.textContent=label; row.appendChild(sect);

  const left=document.createElement('div');
  const useCk=document.createElement('input'); useCk.type='checkbox'; useCk.checked=state.use;
  const useLbl=document.createElement('label'); useLbl.className='small'; useLbl.style.marginLeft='6px'; useLbl.textContent='ã“ã®åŒºåˆ†ã‚’æå‡ºã™ã‚‹';
  const uWrap=document.createElement('div'); uWrap.appendChild(useCk); uWrap.appendChild(useLbl);
  left.appendChild(uWrap); row.appendChild(left);

  const mid=document.createElement('div');
  const sSel=document.createElement('select'); const eSel=document.createElement('select');
  options.forEach(t=>{ sSel.add(new Option(t,t)); eSel.add(new Option(t,t)); });
  sSel.value=state.start; eSel.value=state.end;
  sSel.onchange=()=>{ state.start=sSel.value; };
  eSel.onchange=()=>{ state.end=eSel.value; };
  mid.appendChild(document.createTextNode('é–‹å§‹ ')); mid.appendChild(sSel);
  mid.appendChild(document.createTextNode('ã€€çµ‚äº† ')); mid.appendChild(eSel);
  row.appendChild(mid);

  const right=document.createElement('div');
  const freeCk=document.createElement('input'); freeCk.type='checkbox'; freeCk.checked=state.free;
  const freeLbl=document.createElement('label'); freeLbl.className='small'; freeLbl.style.marginLeft='6px'; freeLbl.textContent='æ™‚é–“æŒ‡å®šãªã—ï¼ˆâ—¯ï¼‰';
  const rWrap=document.createElement('div'); rWrap.appendChild(freeCk); rWrap.appendChild(freeLbl);
  right.appendChild(rWrap); row.appendChild(right);

  // é€£å‹•
  const sync = () => {
    state.use = useCk.checked;
    state.free = freeCk.checked;
    sSel.disabled = eSel.disabled = state.free || !state.use;
  };
  useCk.onchange=sync; freeCk.onchange=sync; sync();

  return row;
}

/* ===== ã¾ã¨ã‚ã¦é€ä¿¡ ===== */
$('submitAll').onclick = async () => {
  msg.textContent=''; msg.className='msg';
  if(!nameSel.disabled){ alert('ã€Œâœ”ï¸ ãƒ­ãƒƒã‚¯ã€ã§åå‰ã‚’ç¢ºå®šã—ã¦ãã ã•ã„'); return; }
  const nm=nameSel.value||''; if(!nm){ alert('åå‰ã‚’é¸æŠï¼ˆã¾ãŸã¯ç™»éŒ²ï¼‰ã—ã¦ãã ã•ã„'); return; }
  const days=Object.keys(edits).sort();
  if(days.length===0){ alert('æ—¥ä»˜ã‚’é¸æŠã—ã¦ãã ã•ã„'); return; }

  const rows=[];
  for(const ds of days){
    const st=edits[ds];
    const add = (part,keyLabel) => {
      if(!part.use) return;
      if(!part.free){
        if(!part.start || !part.end){ throw new Error(`${ds} ${keyLabel}ï¼šé–‹å§‹/çµ‚äº†ã‚’é¸æŠ`); }
        if(part.start >= part.end){ throw new Error(`${ds} ${keyLabel}ï¼šé–‹å§‹ã¯çµ‚äº†ã‚ˆã‚Šå‰ã«ã—ã¦ãã ã•ã„`); }
      }
      rows.push({
        date: ds,
        staff_name: nm,
        start_time: part.free ? null : part.start,
        end_time:   part.free ? null : part.end,
        note: st.note || ''
      });
    };
    add(st.lunch,'ãƒ©ãƒ³ãƒ'); add(st.dinner,'ãƒ‡ã‚£ãƒŠãƒ¼');
  }
  if(rows.length===0){ alert('æå‡ºå¯¾è±¡ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆå„æ—¥ã®ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãã ã•ã„ï¼‰'); return; }

  const { error } = await supa.from('shifts').insert(rows);
  if(error){ msg.textContent='ã‚¨ãƒ©ãƒ¼ï¼š'+error.message; msg.classList.add('err'); return; }

  msg.textContent='é€ä¿¡ã—ã¾ã—ãŸ âœ”ï¸'; msg.classList.add('ok');
  // å…¥åŠ›ã¯ä¿æŒã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æ—¢å­˜æå‡ºã‚’æ›´æ–°
  loadMonthMarkers(); loadRecent();
};

/* ===== æœ€æ–°ã®æå‡ºï¼ˆé‡è¤‡åãªã—ãƒ»æ—¥ä»˜ï¼‹åå‰ã®ã¿ï¼‰ ===== */
async function loadRecent(){
  const ul=$('recentList'); ul.innerHTML='<li class="note">èª­ã¿è¾¼ã¿ä¸­â€¦</li>';
  const { data, error } = await supa
    .from('shifts')
    .select('date,staff_name,created_at')
    .order('created_at',{ascending:false})
    .limit(400);
  if(error){ ul.innerHTML=`<li class="note">ã‚¨ãƒ©ãƒ¼ï¼š${error.message}</li>`; return; }
  if(!data || data.length===0){ ul.innerHTML='<li class="note">ã¾ã æå‡ºã¯ã‚ã‚Šã¾ã›ã‚“</li>'; return; }

  const map = new Map(); // date -> Set(names)
  data.forEach(r=>{
    if(!r.date || !r.staff_name) return;
    if(!map.has(r.date)) map.set(r.date,new Set());
    map.get(r.date).add(r.staff_name);
  });
  const days = Array.from(map.keys()).sort((a,b)=> (a<b?1:-1)).slice(0,10);
  ul.innerHTML='';
  if(days.length===0){ ul.innerHTML='<li class="note">ã¾ã æå‡ºã¯ã‚ã‚Šã¾ã›ã‚“</li>'; return; }
  days.forEach(d=>{
    const names = Array.from(map.get(d));
    const li=document.createElement('li');
    li.textContent = `${d} ï½œ ${names.join('ã€')}`;
    ul.appendChild(li);
  });
}

/* ===== æå‡ºä¸€è¦§ã¸ ===== */
$('toListBtn').onclick = () => {
  location.href = new URL('shiftlink.html', location.href).href;
};

/* ===== åˆæœŸåŒ– ===== */
(async function init(){
  setToToday();
  renderCalendar();
  await bootstrapNames();
  loadRecent();
  loadMonthMarkers();
})();
</script>
</body>
</html>
